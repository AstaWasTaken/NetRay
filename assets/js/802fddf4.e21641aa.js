"use strict";(self.webpackChunknet_ray_docs=self.webpackChunknet_ray_docs||[]).push([[673],{8449:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"api-reference/requestserver","title":"API Reference - RequestServer","description":"Returned by NetRay:RegisterRequestEvent on the server. Handles the server-side logic for request/response communication initiated by clients (or rarely, by the server towards a client).","source":"@site/docs/api-reference/requestserver.md","sourceDirName":"api-reference","slug":"/api-reference/requestserver","permalink":"/NetRay/docs/api-reference/requestserver","draft":false,"unlisted":false,"editUrl":"https://github.com/AstaWasTaken/NetRay/docs/api-reference/requestserver.md","tags":[],"version":"current","frontMatter":{"title":"API Reference - RequestServer"},"sidebar":"docsSidebar","previous":{"title":"API Reference - ClientEvent","permalink":"/NetRay/docs/api-reference/clientevent"},"next":{"title":"API Reference - RequestClient","permalink":"/NetRay/docs/api-reference/requestclient"}}');var s=r(4848),i=r(8453);const a={title:"API Reference - RequestServer"},l="API: RequestServer",o={},c=[{value:"Methods",id:"methods",level:2},{value:"<code>:OnRequest(callback: function)</code>",id:"onrequestcallback-function",level:3},{value:"<code>:Request(player: Player, data: any): Promise</code>",id:"requestplayer-player-data-any-promise",level:3},{value:"Properties (Internal)",id:"properties-internal",level:2},{value:"Example of Server-Side Request Registration",id:"example-of-server-side-request-registration",level:3}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"api-requestserver",children:"API: RequestServer"})}),"\n",(0,s.jsxs)(n.p,{children:["Returned by ",(0,s.jsx)(n.code,{children:"NetRay:RegisterRequestEvent"})," on the server. Handles the server-side logic for request/response communication initiated by clients (or rarely, by the server towards a client)."]}),"\n",(0,s.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(n.h3,{id:"onrequestcallback-function",children:(0,s.jsx)(n.code,{children:":OnRequest(callback: function)"})}),"\n",(0,s.jsxs)(n.p,{children:["Registers the primary handler function that executes when a request is received ",(0,s.jsx)(n.em,{children:"from"})," a client for this endpoint. This function ",(0,s.jsx)(n.strong,{children:"must"})," return a value (the response) or ",(0,s.jsx)(n.code,{children:"error()"})," to reject the client's Promise."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"callback(player: Player, data: any) -> response: any"})}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"player"}),": The ",(0,s.jsx)(n.code,{children:"Player"})," instance making the request."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"data"}),": The request payload sent by the client (validated against ",(0,s.jsx)(n.code,{children:"requestTypeDefinition"})," if provided)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Return Value"}),": The data to send back as the response to the client. This value is validated against ",(0,s.jsx)(n.code,{children:"responseTypeDefinition"})," if provided. If the callback ",(0,s.jsx)(n.code,{children:"error()"}),"s, the client's Promise is rejected with the error message."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'local getDataRequest = NetRay:RegisterRequestEvent("GetPlayerData", {\n    responseTypeDefinition = { level = "number", xp = "number" }\n})\n\nlocal PlayerDataModule = require(game.ServerStorage.PlayerData)\n\ngetDataRequest:OnRequest(function(player, data)\n    -- \'data\' might be empty or contain specifics like {\'field\': \'level\'}\n    local userId = player.UserId\n    local level = PlayerDataModule:GetLevel(userId)\n    local xp = PlayerDataModule:GetXP(userId)\n\n    if level == nil or xp == nil then\n        error("Could not load player data for " .. player.Name) -- Rejects client Promise\n    end\n\n    return { level = level, xp = xp } -- Resolves client Promise\nend)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"requestplayer-player-data-any-promise",children:(0,s.jsx)(n.code,{children:":Request(player: Player, data: any): Promise"})}),"\n",(0,s.jsxs)(n.p,{children:["(Less Common Usage) Initiates a request ",(0,s.jsx)(n.em,{children:"from"})," the server ",(0,s.jsx)(n.em,{children:"to"})," a specific client. The client must have registered the same request name and provided an ",(0,s.jsx)(n.code,{children:":OnRequest"})," handler."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"player"}),": The target ",(0,s.jsx)(n.code,{children:"Player"})," instance to send the request to."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"data"}),": The data payload to send with the request (validated against the ",(0,s.jsx)(n.em,{children:"client's"})," ",(0,s.jsx)(n.code,{children:"requestTypeDefinition"})," if they defined one)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Returns"}),": A ",(0,s.jsx)(n.code,{children:"Promise"})," that resolves with the client's response or rejects on error/timeout. The response is validated against ",(0,s.jsx)(n.em,{children:"this"})," (server's) ",(0,s.jsx)(n.code,{children:"responseTypeDefinition"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'local promptClientAction = NetRay:RegisterRequestEvent("PromptAction", {\n    responseTypeDefinition = { confirmed = "boolean" } -- Server expects boolean confirmation back\n})\n\nlocal function askPlayerToConfirm(player)\n    promptClientAction:Request(player, { prompt = "Accept Quest?" })\n        :andThen(function(response) -- Response from client handler\n            if response.confirmed then\n                print(player.Name, "accepted the quest.")\n                -- Grant quest\n            else\n                print(player.Name, "declined the quest.")\n            end\n        end)\n        :catch(function(err)\n            warn("Failed to get confirmation from", player.Name, ":", err)\n        end)\nend\n'})}),"\n",(0,s.jsx)(n.h2,{id:"properties-internal",children:"Properties (Internal)"}),"\n",(0,s.jsx)(n.p,{children:"Holds references to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Name"}),": Request name string."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Options"}),": Registration options."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ServerManager"}),": Parent manager instance."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RemoteFunction"}),": Underlying Roblox ",(0,s.jsx)(n.code,{children:"RemoteFunction"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"example-of-server-side-request-registration",children:"Example of Server-Side Request Registration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'-- Example of server-side request registration\nlocal getDataRequest = NetRay:RegisterRequestEvent("GetPlayerData", {\n    responseTypeDefinition = { level = "number", xp = "number" }\n})\n\nlocal PlayerDataModule = require(game.ServerStorage.PlayerData)\n\n-- Server-side handler\ngetDataRequest.OnServerInvoke = function(player)\n    local data = PlayerDataModule:GetData(player)\n    return {\n        level = data.level,\n        xp = data.xp\n    }\nend\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>l});var t=r(6540);const s={},i=t.createContext(s);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);